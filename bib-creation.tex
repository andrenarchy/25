%% -*- coding:utf-8 -*-
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%   $RCSfile: grammatiktheorie.tex,v $
%%  $Revision: 1.3 $
%%      $Date: 2010/01/18 14:55:27 $
%%     Author: Stefan Mueller (CL Uni-Bremen)
%%    Purpose: 
%%   Language: LaTeX
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%% This file is exactly like grammatical-theory.tex
%%% except that the bibliography is taken from biblio.bib
%%% The aux file is then used to generate gt.bib


\documentclass{scrbook}                          


% load all the stuff which is loaded by langsci otherwise

\newcommand{\il}[1]{}
\newcommand{\is}[1]{}

\usepackage{index,authorindex}

%% hspace over width of something without showing it
\newlength{\LSPTmp}
\newcommand*{\hspaceThis}[1]{\settowidth{\LSPTmp}{#1}\hspace*{\LSPTmp}}

\usepackage{ifthen}
\provideboolean{draft}
\setboolean{draft}{false}
%\setboolean{draft}{true}

\usepackage{etoolbox}
\newtoggle{draft}\togglefalse{draft}


\usepackage{langsci/styles/langsci-basic}
\usepackage{booktabs} % for nicer lines


\newcommand{\NOTE}[1]{}
%\newcommand{\NOTE}[1]{\marginpar{#1}}

\newcommand{\LATER}[1]{}

\usepackage{hyperref,todonotes,natbib}

\let\citew\citealt

%\input{localmetadata.tex}
%\input{localpackages.tex}
%\input{localcommands.tex}

%\usepackage{bigfoot}


% http://tex.stackexchange.com/questions/38607/no-room-for-a-new-dimen
\usepackage{etex}\reserveinserts{28}

% http://tex.stackexchange.com/questions/229500/tikzmark-and-xelatex
% temporary fix, remove later
%\newcount\pdftexversion \pdftexversion140 \def\pgfsysdriver{pgfsys-dvipdfm.def} \usepackage{tikz} \usetikzlibrary{tikzmark}

%\usepackage[section]{placeins}

\usepackage{eurosym} % should go once Berthold fixes unicode


% http://tex.stackexchange.com/questions/284097/subscript-like-math-but-without-the-minus-sign?noredirect=1#comment685345_284097
% for subscripts
\usepackage{amsmath}
%\usepackage{unicode-math} breaks the CCG derivations, the horizontal lines are too high


% \justify to switch of \raggedright in translations
%\usepackage{ragged2e}

% Haitao Liu
\usepackage{xeCJK}
\setCJKmainfont{SimSun}



\hypersetup{bookmarksopenlevel=0}

%% now loaded by the langsci class
%% \iftoggle{draft}{
%% \usepackage{todonotes}
%% }{
%% \usepackage[disable]{todonotes}
%% }

\iftoggle{draft}{}{
\presetkeys{todonotes}{disable}{}
}


\usepackage{metalogo} % xelatex

\usepackage{multicol}

\usepackage{bookmark}

\usepackage{styles/my-ccg-ohne-colortbl}

\usepackage{langsci/styles/jambox}

% This has side effects on my-ccg commands do no know why
%\usepackage{langsci/styles/langsci-optional}

\usepackage{styles/oneline}

\usepackage{langsci/styles/langsci-lgr}

\usepackage{graphicx}



\usepackage{lastpage,float,soul,tabularx}




\usepackage{styles/ogonek}        % For Ewa Dabrowska


\usepackage{styles/mycommands}% \spacebr


% still needed
% for direction of government examples
% for CoreGram classes
% and one \Tree in mts.tex
\usepackage{tikz-qtree}

\usepackage{langsci/styles/langsci-gb4e}


\usepackage{subfig}

%\renewcommand{\xbar}{X̅\xspace}


%\usepackage[external,linguistics]{styles/forest/forest}


% for reasons I do not understand this cannot be moved further down and 
% the loading of forest further down cannot be removed. St. Mü. 26.01.2017
% It breaks the dependency grammar trees in forest.
\usepackage{langsci/styles/langsci-forest-setup}


\forestset{
      terminus/.style={tier=word, for children={tier=tabular}, for tree={fit=band}, for descendants={no path, align=left, l sep=0pt}},
      sn edges original/.style={for tree={parent anchor=south, child anchor=north,align=center,base=top}},
      no path/.style={edge path={}},
      set me left/.style={calign with current edge, child anchor=north west, for parent={parent anchor=south west}},
}





% has to be loaded after forest-setup because of incompatibilities with the dg-style.
\usepackage{german}\selectlanguage{USenglish}

\usepackage{styles/merkmalstruktur,styles/abbrev,styles/makros.2e,styles/my-xspace,styles/article-ex,styles/additional-langsci-index-shortcuts,
styles/eng-date,styles/my-theorems}

% loaded in macros.2e \usepackage[english]{varioref}
% do not stop and warn! This will be tested in the final version
%\vrefwarning


\setcounter{secnumdepth}{4}


\usepackage{styles/dgmacros,pst-tree,styles/trees,styles/dalrymple} % Mary Dalrymples macros


%%% trick for using adjustbox
\let\pstricksclipbox\clipbox
\let\clipbox\relax

% http://tex.stackexchange.com/questions/206728/aligning-several-forest-trees-in-centered-way/206731#206731
% for aligning TAG trees
\usepackage[export]{adjustbox}

% draw a grid for getting the coordinates
\usepackage{styles/tikz-grid}

% for offsets in trees
\newlength{\offset}
\newlength{\offsetup}

\ifxetex
\usepackage{styles/eng-hyp-utf8}
\else
\usepackage{styles/eng-hyp}
\fi

\usepackage{appendix}


% adds lines to both the odd and even page.
% bloddy hell! This is really an alpha package! Do not use the draft option! 07.03.2016
\usepackage{addlines}

%% \let\addlinesold=\addlines
%% % there is one optional argument. Second element in brackets is the default 
%% \renewcommand{\addlines}[1][1]{
%% \todosatz{addlines}
%% \addlinesold[#1]
%% }


% do nothing now
%\let\addlinesold=\addlines
\renewcommand{\addlines}[1][1]{}

% for addlines to work
\strictpagecheck



% http://tex.stackexchange.com/questions/3223/subscripts-for-primed-variables
%
% to get 
% {}[ af   [~]\sub{V} ]\sub{V$'$}
%
% typeset properly. Thanks, Sebastian.
%
\usepackage{subdepth}


%\usepackage{caption}



\usepackage{langsci/styles/langsci-tbls}
% do not need identation for enumerate since we are in a box anyway.
\usepackage{enumitem}





% requires amsmath for \text
\newcommand\mathdash{\text{\normalfont -}}

\newcommand{\todostefan}[1]{\todo[color=green!40]{\footnotesize #1}\xspace}
\newcommand{\todosatz}[1]{\todo[color=red!40]{\footnotesize #1}\xspace}
\newcommand{\todoandrew}[1]{\todo[color=blue!40]{\footnotesize #1}\xspace}

\newcommand{\inlinetodostefan}[1]{\todo[color=green!40,inline]{\footnotesize #1}\xspace}
\newcommand{\inlinetodoandrew}[1]{\todo[color=red!40,inline]{\footnotesize #1}\xspace}


%% \newcommand{\remarkstefan}[1]{\todo[color=green!40]{\footnotesize #1}\xspace}
%% \newcommand{\remarkbjarne}[1]{\todo[color=red!40]{\footnotesize #1}\xspace}

%% \newcommand{\inlineremarkstefan}[1]{\todo[color=green!40,inline]{\footnotesize #1}\xspace}
%% \newcommand{\inlineremarkbjarne}[1]{\todo[color=red!40,inline]{\footnotesize #1}\xspace}

\newcommand{\treeag}{TAG\indextag}

%% is done by package option 
\ifdraft
\proofmodetrue
\fi


%% % taken from covington.sty (check)
%% %\newcounter{lsptempcnt}

%% \newcommand{\mex}[1]{\setcounter{lsptempcnt}{\value{equation}}%
%% \addtocounter{lsptempcnt}{#1}%
%% \arabic{lsptempcnt}}%

%\displaywidowpenalty=10000\relax
%\predisplaypenalty=-200\relax


%\newcommand{\mod}{\textsc{mod}\xspace}  % wegen beamer.cls nicht in abbrev.sty

%\usepackage[figuresright]{rotating}


% http://tex.stackexchange.com/questions/203/how-to-obtain-verbatim-text-in-a-footnote
% somehow does not work
%\usepackage{fancyvrb}

%\newcommand{\tag}{TAG\indextag} % has to be here, conflict with latexbeamer

% mit der Index-Version geht die Silbentrennung nicht
\renewcommand{\word}[1]{\emph{#1}}

%\newcommand{\dom}{\textsc{dom}\xspace}

\newcommand{\prt}{\textsc{prt}}
%\newcommand{\refl}{\textsc{refl}}

%% \newcommand{\snom}{\textit{snom}}
%% \newcommand{\sgen}{\textit{sgen}}
%% \newcommand{\sacc}{\textit{sacc}}

%\usepackage{my-index-shortcuts}

\newcommand{\tes}{Tesnière\xspace}
\newcommand{\mel}{Mel'čuk\xspace}
\newcommand{\dom}{\textsc{dom}\xspace}


\newcommand{\page}{}

\newcommand{\ia}[1]{}

\let\mc=\multicolumn


%\exewidth{\exnrfont (34)}
% should be set up for the whole series in langsci.cls
\renewcommand{\fnexfont}{\footnotesize\upshape}
%\let\oldglt\glt
%\def\glt{\oldglt\justify}
%\def\glt{\nopagebreak\vskip.17\baselineskip\transfont\parindent0ex}

\makeatletter
\def\ea{\ifnum\@xnumdepth=0\begin{exe}\else\begin{xlist}[iv.]\fi\ex}
\def\eal{\begin{exe}\exnrfont\ex\begin{xlist}[iv.]}

\def\gll%                  % Introduces 2-line text-and-gloss.
    {
%\raggedright%
        \bgroup
     \ifx\@gsingle1%           conditionally force single spacing (hpk/MC)
	 \def\baselinestretch{1}\@selfnt\fi
%        \vskip\baselineskip\def\baselinestretch{1}%
%        \@selfnt\vskip-\baselineskip\fi%
    \bgroup
    \twosent
   }
\makeatother


% to set the MRSes for scope underspecification
%http://tex.stackexchange.com/questions/218417/replacing-tree-dvips-connect-nodes-in-a-tabular-environment/218458#218458
\usepackage{tcolorbox}
\tcbuselibrary{skins}
% for texlive 2015
\newtcbox{\mybox}[1][]{empty,shrink tight,nobeforeafter,on line,before upper=\vphantom{gM},remember as=#1,top=2pt,bottom=2pt}

% for texlive 2013
%\newtcbox{\mybox}[1][]{enhanced,boxrule=0pt,colframe=white,colback=white,shrink tight,nobeforeafter,on line,before upper=\vphantom{gM},remember as=#1} %,top=3pt,bottom=3pt}
                                %use shorten <=2pt,shorten >=2pt in the pictures.

\newcommand{\mynode}[2]{\mybox[#1]{#2}}


% http://tex.stackexchange.com/questions/218417/replacing-tree-dvips-connect-nodes-in-a-tabular-environment/218458#218458
% Instead of using the package tikzmark, you can define your own \tikzmark being a regular node. There's no need to use tcolorbox package.
\newcommand{\mysubnode}[2]%
    {\tikz[baseline=(#1.base), remember picture]\node[outer sep=0pt, inner sep=0pt] (#1) {#2};}

% http://tex.stackexchange.com/questions/230300/doing-something-like-psframebox-in-tikz#230306
\tikzset{
frbox/.style={
  rounded corners,
  draw,
  thick,
  inner sep=5pt
  }
}
\newcommand\TZbox[1]{\tikz\node[frbox,baseline] {#1};}

\renewcommand{\rm}{\upshape}
\renewcommand{\mathrm}{\text}
\renewcommand{\it}{\itshape}
\renewcommand{\sc}{\scshape}
\renewcommand{\bf}{\bfseries}




% due to pdf readers facing page does not make sense:

%\def\reftextfaceafter{auf der \reftextvario{gegen\"uberliegenden}{n\"achsten} Seite}%
%\def\reftextfacebefore{auf der \reftextvario{gegen\"uberliegenden}{vorigen} Seite}%

\def\reftextfaceafter{on the following page}%
\def\reftextfacebefore{on the preceeding page}%



% needed for bibtex sorting. Usually provided from the bib file, but this fails for the first run.
\providecommand*{\donothing}[1]{}


% since all the theories are different, we start counting from scratch for every chapter.
% Thanks to Antonio MyP for pointing this out.

\makeatletter
\@addtoreset{principle}{chapter}
\@addtoreset{schema}{chapter}
\makeatother


% http://tex.stackexchange.com/questions/298031/is-it-possible-to-add-a-command-at-the-beginning-of-a-chapter?noredirect=1#
\pretocmd{\chapter}{% <--- IMPORTANT
    \exewidth{(34)}% <--- IMPORTANT
}{}{}


% The oridingal definition from cgloss4e.
% This is incompatible with \jambox, but does raggedright

%% \def\gllr%                 % Introduces 2-line text-and-gloss.
%%    {\begin{flushleft}
%%      \ifx\@gsingle1%           conditionally force single spacing (hpk/MC)
%%         \vskip\baselineskip\def\baselinestretch{1}%
%%         \@selfnt\vskip-\baselineskip\fi%
%%     \bgroup
%%     \twosentr
%%    }


%%    \gdef\twosentr#1\\ #2\\{% #1 = first line, #2 = second line
%%     \getwords(\lineone,\eachwordone)#1 \\%
%%     \getwords(\linetwo,\eachwordtwo)#2 \\%
%%     \loop\lastword{\eachwordone}{\lineone}{\wordone}%
%%          \lastword{\eachwordtwo}{\linetwo}{\wordtwo}%
%%          \global\setbox\gline=\hbox{\unhbox\gline
%%                                     \hskip\glossglue
%%                                     \vtop{\box\wordone   % vtop was vbox
%%                                           \nointerlineskip
%%                                           \box\wordtwo
%%                                          }%
%%                                    }%
%%          \testdone
%%          \ifnotdone
%%     \repeat
%%     \egroup % matches \bgroup in \gloss
%%    \gl@stop}


% http://tex.stackexchange.com/questions/297068/adding-coordinates-for-connection-between-nodes-in-several-forest-environments
%
% is required because the construction of the curves otherwise results in an enormous bounding box,
% which probably isn't what you want. To see what it does, just delete it from the tree and observe
% the results.

\makeatletter
\newcommand*\ignoreme{\pgf@relevantforpicturesizefalse}
\makeatother



% Ash Template LFG

\newcommand{\featname}[1]{\mbox{\textsc{#1}}}    % feature name

\newcommand{\argzero}{\featname{arg$_0$}\xspace}
\newcommand{\argone}{\featname{arg$_1$}\xspace}
\newcommand{\argtwo}{\featname{arg$_2$}\xspace}
\newcommand{\argthree}{\featname{arg$_3$}\xspace}

\newcommand{\templaten}[1]{\textsc{#1}}


% the distance between (i) and the example
%\gblabelsep{1em}



%https://tex.stackexchange.com/questions/11707/how-to-force-output-to-a-left-or-right-page
%% \newcommand*\cleartoleftpage{%
%%   \clearpage
%%   \ifodd\value{page}\hbox{}\newpage\fi
%% }



% https://tex.stackexchange.com/questions/95014/aligning-overline-to-italics-font/95079#95079
\newbox\usefulbox

\makeatletter
    \def\getslant #1{\strip@pt\fontdimen1 #1}

    \def\skoverline #1{\mathchoice
     {{\setbox\usefulbox=\hbox{$\m@th\displaystyle #1$}%
        \dimen@ \getslant\the\textfont\symletters \ht\usefulbox
        \divide\dimen@ \tw@ 
        \kern\dimen@ 
        \overline{\kern-\dimen@ \box\usefulbox\kern\dimen@ }\kern-\dimen@ }}
     {{\setbox\usefulbox=\hbox{$\m@th\textstyle #1$}%
        \dimen@ \getslant\the\textfont\symletters \ht\usefulbox
        \divide\dimen@ \tw@ 
        \kern\dimen@ 
        \overline{\kern-\dimen@ \box\usefulbox\kern\dimen@ }\kern-\dimen@ }}
     {{\setbox\usefulbox=\hbox{$\m@th\scriptstyle #1$}%
        \dimen@ \getslant\the\scriptfont\symletters \ht\usefulbox
        \divide\dimen@ \tw@ 
        \kern\dimen@ 
        \overline{\kern-\dimen@ \box\usefulbox\kern\dimen@ }\kern-\dimen@ }}
     {{\setbox\usefulbox=\hbox{$\m@th\scriptscriptstyle #1$}%
        \dimen@ \getslant\the\scriptscriptfont\symletters \ht\usefulbox
        \divide\dimen@ \tw@ 
        \kern\dimen@ 
        \overline{\kern-\dimen@ \box\usefulbox\kern\dimen@ }\kern-\dimen@ }}%
     {}}
    \makeatother



\newcommand{\questions}[1]{\bigskip
\tblssy{people}{Comprehension Questions}{\setlist{leftmargin=*}#1}}
%\tblssy{people}{Comprehension Questions}{#1}}

\newcommand{\exercises}[1]{
\tblssy{pencil}{Exercises}{\setlist{leftmargin=*}#1}}
%\tblssy{pencil}{Exercises}{#1}}

\newcommand{\furtherreading}[1]{\tblssy{book}{Further reading}{#1}}


\robustify\textsc
\robustify\textit








%\AtEveryBibitem{\clearfield{abstract}}
%\AtEveryBibitem{\clearfield{location}}
%\AtEveryBibitem{\clearfield{ANNOTATION}}

\title{Das Buch}
\author{Icke}

\begin{document}

\frontmatter
\maketitle

% Mit Widmung geht es auf S. 7 los
\thispagestyle{empty}~\newpage\setcounter{page}{7}% for printing 2up

\tableofcontents

\include{chapters/preface}
\include{chapters/acknowledgments}
\include{chapters/ontheway}
\include{chapters/langsci}

\mainmatter

\part{Background and specific theories}

\include{chapters/1-begriffe}
\include{chapters/2-psg}
\include{chapters/3-gb}
\include{chapters/3-minimalism}
\include{chapters/4-gpsg}
\include{chapters/5-merkmalstrukturen}
\include{chapters/6-lfg}
\include{chapters/7-cg}
\include{chapters/8-hpsg}
\include{chapters/9-cxg}
\include{chapters/dg}
\include{chapters/tag}
\include{chapters/ot}

\part{General discussion}\label{part-discussion}

\include{chapters/innateness}
\include{chapters/mts}
\include{chapters/competence}
\include{chapters/acquisition}
\include{chapters/complexity}
\include{chapters/branching-locality-recursion}
\include{chapters/empty}
\include{chapters/movement}
\include{chapters/phrasal}
\include{chapters/potential-structure}
\include{chapters/coregram}
\include{chapters/conclusions}
\include{chapters/loesungen}

\backmatter
\bookmarksetup{startatroot}

\bibliographystyle{unified} 
\bibliography{bib-abbr,biblio}



\end{document}

